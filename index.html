<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEON INTERVAL TIMER (FINAL AD READY)</title>
    <style>
        :root {
            --neon-green: #39FF14;
            --neon-blue: #00F3FF;
            --neon-red: #FF3131;
            --bg-dark: #121212;
            --card-bg: #1e1e1e;
            --ad-height: 60px;
        }
        body {
            background-color: var(--bg-dark); color: white;
            font-family: 'Segoe UI', sans-serif;
            display: flex; flex-direction: column; align-items: center;
            padding: 20px 20px calc(20px + var(--ad-height)) 20px;
            margin: 0; min-height: 100vh; box-sizing: border-box;
        }
        
        .display-card {
            background: var(--card-bg); border: 2px solid var(--neon-blue);
            border-radius: 20px; width: 100%; max-width: 400px;
            padding: 20px 15px; text-align: center;
            box-shadow: 0 0 15px var(--neon-blue); margin-bottom: 15px;
        }
        .main-time { font-size: 5rem; font-weight: bold; color: var(--neon-green); text-shadow: 0 0 20px var(--neon-green); margin: 5px 0; }
        
        .settings-container { width: 100%; max-width: 400px; background: var(--card-bg); border-radius: 20px; padding: 12px; box-sizing: border-box; }
        .step-row { display: flex; align-items: center; gap: 8px; background: #2a2a2a; margin-bottom: 6px; padding: 8px; border-radius: 12px; }
        input[type="number"] { background: #121212; border: 1px solid #444; color: var(--neon-green); border-radius: 5px; padding: 5px; width: 42px; text-align: center; font-weight: bold; }

        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; max-width: 400px; margin-top: 15px; }
        .btn-start { grid-column: span 2; background: var(--neon-green); color: black; padding: 20px; border-radius: 20px; font-weight: bold; border: none; box-shadow: 0 0 15px var(--neon-green); display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .btn-stop { grid-column: span 2; background: var(--neon-red); color: white; padding: 15px; border-radius: 20px; font-weight: bold; border: none; box-shadow: 0 0 10px var(--neon-red); display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .btn-reset-ui { grid-column: span 2; background: #333; color: #ccc; padding: 12px; border-radius: 15px; font-size: 0.8rem; border: none; margin-top: 5px; cursor: pointer; display: flex; flex-direction: column; align-items: center; }

        .ad-placeholder { position: fixed; bottom: 0; left: 0; width: 100%; height: var(--ad-height); background: rgba(0,0,0,0.8); border-top: 1px solid #333; display: flex; align-items: center; justify-content: center; color: #555; font-size: 0.8rem; z-index: 999; }

        #reportModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1001; flex-direction: column; align-items: center; justify-content: center; }
        .report-box { background: #222; border: 3px solid var(--neon-green); padding: 25px; border-radius: 25px; width: 85%; max-width: 320px; }
        .report-val { color: var(--neon-green); font-weight: bold; font-size: 1.4rem; }
        .ad-guide-btn { background: var(--neon-blue); color: black; padding: 18px; border-radius: 18px; font-size: 1.3rem; width: 100%; border: none; font-weight: bold; margin-top: 15px; }
        /* ÏïàÎÇ¥ Î¨∏Íµ¨ Ïä§ÌÉÄÏùº */
        .ad-skip-hint { font-size: 0.75rem; color: #aaa; margin-top: 12px; line-height: 1.4; text-align: center; }
    </style>
</head>
<body>

    <div class="display-card">
        <div id="statusLabel" style="color:var(--neon-blue); font-size:0.9rem;">READY?</div>
        <div class="main-time" id="timerDisplay">00:00</div>
        <div style="font-size:0.9rem;">ROUND: <span id="currentRoundDisplay">1</span> / <span id="totalRoundsDisplay">10</span></div>
    </div>

    <div class="settings-container">
        <div style="display:flex; justify-content:space-between; margin-bottom:8px; font-size:0.9rem;">
            <span>TOTAL ROUNDS</span>
            <input type="number" id="totalRoundsInput" value="10" onchange="updateRounds()">
        </div>
        <div id="stepsContainer"></div>
    </div>

    <div class="btn-grid">
        <button id="mainBtn" class="btn-start" onclick="handleMainBtn()">
            <span id="mainIcon" style="font-size: 2rem;">‚ñ∂</span>
            <span id="mainText" style="font-size: 0.7rem;">(START)</span>
        </button>
        <button class="btn-stop" onclick="stopAndResetTimer()">
            <span style="font-size: 1.5rem;">‚ñ†</span>
            <span style="font-size: 0.7rem;">(STOP)</span>
        </button>
        <button class="btn-reset-ui" onclick="fullReset()">
            <span style="font-size: 1rem;">‚Ü∫</span>
            <span>(RESET ALL SETTINGS)</span>
        </button>
    </div>

    <div class="ad-placeholder">AD BANNER AREA</div>

    <div id="reportModal">
        <div id="preReport" style="text-align:center; padding: 20px; width: 100%; max-width: 320px;">
            <h1 style="color:var(--neon-green); font-size:2.2rem; margin-bottom: 10px;">YOU DID IT! üèÜ</h1>
            <p style="margin-bottom: 20px;">Ïò§ÎäòÏùò Ïö¥Îèô Î¶¨Ìè¨Ìä∏Í∞Ä Ï§ÄÎπÑÎêòÏóàÏäµÎãàÎã§.</p>
            
            <button class="ad-guide-btn" onclick="showFinalReport()">VIEW REPORT</button>
            
            <p class="ad-skip-hint">
                ‚Äª Î¶¨Ìè¨Ìä∏ ÌôïÏù∏ Ï†Ñ ÏßßÏùÄ Í¥ëÍ≥†Í∞Ä ÌëúÏãúÎê©ÎãàÎã§.<br>
                Í¥ëÍ≥† ÏãúÏûë ÌõÑ ÏÉÅÎã®Ïùò 'X'Î•º ÎàÑÎ•¥Î©¥ Î∞îÎ°ú Ïä§ÌÇµ Í∞ÄÎä•Ìï©ÎãàÎã§.
            </p>
        </div>

        <div id="finalReport" style="display:none;" class="report-box">
            <h2 style="color:var(--neon-green); text-align:center; margin-top: 0;">WORKOUT REPORT</h2>
            <div style="margin:12px 0;">TIME: <span id="resTime" class="report-val">00:00</span></div>
            <div style="margin:12px 0;">ROUNDS: <span id="resRound" class="report-val">0/0</span></div>
            <div style="margin:12px 0;">STEPS: <span id="resSteps" class="report-val">0</span></div>
            <button onclick="closeModal()" style="width:100%; margin-top:20px; background:var(--neon-green); padding:12px; border:none; border-radius:12px; font-weight:bold; color: black;">CLOSE</button>
        </div>
    </div>

    <script>
        let timerInterval, bpmInterval;
        let isRunning = false, isPaused = false;
        let currentStep = 1, currentRound = 1, timeLeft = 0;
        let totalSec = 0, totalSteps = 0;

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(f, d, v) {
            const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
            o.connect(g); g.connect(audioCtx.destination);
            o.frequency.setValueAtTime(f, audioCtx.currentTime);
            g.gain.setValueAtTime(v, audioCtx.currentTime);
            o.start(); o.stop(audioCtx.currentTime + d);
        }

        function speakEncouragement() {
            const msg = new SpeechSynthesisUtterance("You did it! Great job today! You are amazing.");
            msg.lang = 'en-US'; msg.rate = 0.9;
            window.speechSynthesis.speak(msg);
        }

        const container = document.getElementById('stepsContainer');
        for(let i=1; i<=5; i++) {
            container.innerHTML += `<div class="step-row">
                <input type="checkbox" id="check${i}" ${i<=2?'checked':''}>
                <span style="font-size:0.7rem; width:45px;">STEP ${i}</span>
                <input type="number" id="min${i}" value="0"> <span style="font-size:0.6rem;">M</span>
                <input type="number" id="sec${i}" value="${i==1?10:5}"> <span style="font-size:0.6rem;">S</span>
                <input type="number" id="bpm${i}" value="${i==1?60:120}"> <span style="font-size:0.5rem;">BPM</span>
            </div>`;
        }

        function updateRounds() { document.getElementById('totalRoundsDisplay').innerText = document.getElementById('totalRoundsInput').value; }
        function handleMainBtn() { if(!isRunning || isPaused) startTimer(); else pauseTimer(); }

        function startTimer() {
            if(audioCtx.state==='suspended') audioCtx.resume();
            isRunning = true; isPaused = false;
            document.getElementById('mainIcon').innerText = "‚ùö‚ùö";
            document.getElementById('mainText').innerText = "(PAUSE)";
            document.getElementById('mainBtn').style.background = "#FFD700";
            if(timeLeft <= 0) loadStep();
            timerInterval = setInterval(() => {
                if(timeLeft <= 0) nextStep();
                else {
                    timeLeft--; totalSec++;
                    if(timeLeft < 3) playSound(1200, 0.1, 0.2);
                    updateDisplay();
                }
            }, 1000);
            startBpm();
        }

        function stopAndResetTimer() {
            clearInterval(timerInterval); clearInterval(bpmInterval);
            isRunning = false; isPaused = false;
            currentStep = 1; currentRound = 1; timeLeft = 0; totalSec = 0; totalSteps = 0;
            document.getElementById('timerDisplay').innerText = "00:00";
            document.getElementById('currentRoundDisplay').innerText = "1";
            document.getElementById('statusLabel').innerText = "READY?";
            document.getElementById('mainIcon').innerText = "‚ñ∂";
            document.getElementById('mainText').innerText = "(START)";
            document.getElementById('mainBtn').style.background = "var(--neon-green)";
        }

        function fullReset() { if(confirm("Î™®Îì† ÏÑ§Ï†ïÍ∞íÏùÑ Ï¥àÍ∏∞Í∞íÏúºÎ°ú Î¶¨ÏÖãÌï†ÍπåÏöî?")) location.reload(); }

        function loadStep() {
            const m = parseInt(document.getElementById(`min${currentStep}`).value)||0;
            const s = parseInt(document.getElementById(`sec${currentStep}`).value)||0;
            timeLeft = m*60 + s; totalSteps++;
            document.getElementById('statusLabel').innerText = `STEP ${currentStep} RUNNING`;
            updateDisplay();
        }

        function startBpm() {
            clearInterval(bpmInterval);
            const bpm = parseInt(document.getElementById(`bpm${currentStep}`).value)||0;
            if(bpm>0) bpmInterval = setInterval(()=>playSound(440, 0.03, 0.05), 60000/bpm);
        }

        function nextStep() {
            clearInterval(timerInterval); clearInterval(bpmInterval);
            currentStep++;
            if(currentStep > 5 || !document.getElementById(`check${currentStep}`).checked) {
                currentStep = 1; currentRound++;
                if(currentRound > parseInt(document.getElementById('totalRoundsInput').value)) return finish();
                document.getElementById('currentRoundDisplay').innerText = currentRound;
            }
            loadStep(); startTimer();
        }

        function finish() {
            clearInterval(timerInterval); clearInterval(bpmInterval);
            playSound(523, 0.2, 0.1); 
            setTimeout(()=>playSound(659, 0.2, 0.1), 150); 
            setTimeout(()=>playSound(783, 0.4, 0.1), 300);
            setTimeout(speakEncouragement, 800);
            document.getElementById('reportModal').style.display = 'flex';
            document.getElementById('resTime').innerText = `${Math.floor(totalSec/60)}m ${totalSec%60}s`;
            document.getElementById('resRound').innerText = `${currentRound-1} / ${document.getElementById('totalRoundsInput').value}`;
            document.getElementById('resSteps').innerText = totalSteps;
        }

        function showFinalReport() {
            document.getElementById('preReport').style.display = 'none';
            document.getElementById('finalReport').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('reportModal').style.display = 'none';
            document.getElementById('finalReport').style.display = 'none';
            document.getElementById('preReport').style.display = 'block';
            stopAndResetTimer();
        }

        function pauseTimer() {
            clearInterval(timerInterval); clearInterval(bpmInterval);
            isPaused = true;
            document.getElementById('mainIcon').innerText = "‚ñ∂";
            document.getElementById('mainText').innerText = "(RESUME)";
            document.getElementById('mainBtn').style.background = "var(--neon-green)";
        }

        function updateDisplay() {
            const m = Math.floor(timeLeft/60).toString().padStart(2,'0');
            const s = (timeLeft%60).toString().padStart(2,'0');
            document.getElementById('timerDisplay').innerText = `${m}:${s}`;
        }
        updateRounds();
    </script>
</body>
</html>
